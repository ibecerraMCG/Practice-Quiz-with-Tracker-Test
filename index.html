<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CP-Heme Practice Quizzes Directory</title>
    
    <!-- Umami Analytics Tracker -->
    <script defer src="https://cloud.umami.is/script.js" data-website-id="3cb2ed63-b477-4c85-a83f-7352712d49c9"></script>

    <style>
        /* --- CSS Variables & Themes --- */
        :root {
            --transition-speed: 0.3s;
            --font-main: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        /* 1. Modern Dark (Default) */
        [data-theme="dark"] {
            --bg-body: #1e293b;
            --bg-card: #334155;
            --bg-header: #0f172a;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --text-accent: #38bdf8;
            --border-color: #475569;
            --highlight-bg: #475569;
            --button-bg: #38bdf8;
            --button-text: #0f172a;
            --button-hover: #0ea5e9;
        }

        /* 2. Modern Light */
        [data-theme="light"] {
            --bg-body: #f3f4f6;
            --bg-card: #ffffff;
            --bg-header: #ffffff;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --text-accent: #2563eb;
            --border-color: #e5e7eb;
            --highlight-bg: #f3f4f6;
            --button-bg: #2563eb;
            --button-text: #ffffff;
            --button-hover: #1d4ed8;
        }

        /* 3. Midnight (Pure Black) */
        [data-theme="midnight"] {
            --bg-body: #000000;
            --bg-card: #000000;
            --bg-header: #000000;
            --text-main: #e0e0e0;
            --text-muted: #888888;
            --text-accent: #90caf9;
            --border-color: #333333;
            --highlight-bg: #1a1a1a;
            --button-bg: #90caf9;
            --button-text: #000000;
            --button-hover: #42a5f5;
        }

        /* 4. Legacy Dark (Original) */
        [data-theme="legacy-dark"] {
            --bg-body: #2d343e;
            --bg-card: #3c424f;
            --bg-header: #3c424f;
            --text-main: #e8e6e3;
            --text-muted: #b0c4de;
            --text-accent: #8ab4f8;
            --border-color: #555;
            --highlight-bg: #454c5a;
            --button-bg: #8ab4f8;
            --button-text: #202124;
            --button-hover: #a3c5f9;
        }

        /* 5. Sepia (Reading Mode) */
        [data-theme="sepia"] {
            --bg-body: #f4ecd8;
            --bg-card: #fdf6e3;
            --bg-header: #e4d5b7;
            --text-main: #433422;
            --text-muted: #7c6f5a;
            --text-accent: #a05a2c;
            --border-color: #d3c4a5;
            --highlight-bg: #ebe1c9;
            --button-bg: #a05a2c;
            --button-text: #fdf6e3;
            --button-hover: #864822;
        }

        /* 6. High Contrast */
        [data-theme="contrast"] {
            --bg-body: #000000;
            --bg-card: #000000;
            --bg-header: #000000;
            --text-main: #ffffff;
            --text-muted: #dddddd;
            --text-accent: #ffff00;
            --border-color: #ffffff;
            --highlight-bg: #333333;
            --button-bg: #ffff00;
            --button-text: #000000;
            --button-hover: #e6e600;
        }

        /* --- Global Reset & Layout --- */
        * { box-sizing: border-box; }
        
        body {
            font-family: var(--font-main);
            margin: 0;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: background-color var(--transition-speed), color var(--transition-speed);
            line-height: 1.6;
        }

        /* --- Header --- */
        header {
            background-color: var(--bg-header);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        header.unpinned {
            position: relative;
            box-shadow: none;
        }

        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            flex-wrap: wrap;
            gap: 15px;
        }

        header h1 {
            font-size: 1.5rem;
            margin: 0;
            color: var(--text-accent);
        }

        .controls-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        /* --- Live Viewer Tracker Widget --- */
        .live-tracker {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 0 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--text-main);
            height: 34px;
            font-family: monospace;
            font-weight: bold;
            cursor: default;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background-color: #22c55e; /* Green */
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 6px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }

        /* --- Controls --- */
        .pin-btn {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-main);
            cursor: pointer;
            padding: 0 10px;
            border-radius: 6px;
            font-size: 1rem;
            transition: background-color 0.2s;
            height: 34px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pin-btn:hover {
            background-color: var(--highlight-bg);
        }

        .pin-btn.pin-active {
            color: var(--text-accent);
            border-color: var(--text-accent);
            background-color: rgba(0, 0, 0, 0.1);
        }

        .theme-control {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        select#theme-select {
            padding: 0 12px;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            background-color: var(--bg-card);
            color: var(--text-main);
            cursor: pointer;
            font-family: inherit;
            height: 34px;
        }

        /* --- Section Navigation --- */
        .section-nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .section-nav button {
            background-color: var(--highlight-bg);
            color: var(--text-main);
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .section-nav button:hover {
            border-color: var(--text-accent);
            color: var(--text-accent);
        }

        /* --- Main Content --- */
        .container {
            max-width: 950px;
            margin: 2rem auto;
            padding: 0 1rem 4rem 1rem;
        }

        /* --- Directory Cards --- */
        .week-section {
            margin-bottom: 3rem;
            scroll-margin-top: 150px; /* Offset for sticky header */
        }

        .week-title {
            color: var(--text-accent);
            border-bottom: 2px solid var(--text-accent);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .day-card {
            background-color: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1.5rem;
            box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .day-card:hover {
            transform: translateY(-2px);
        }

        .day-info {
            display: flex;
            align-items: flex-start;
            gap: 1.5rem;
            flex: 1;
        }

        .day-badge {
            background-color: var(--highlight-bg);
            color: var(--text-main);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: bold;
            min-width: 130px;
            text-align: center;
            border: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .topic-list {
            margin: 0;
            padding-left: 1.2rem;
            color: var(--text-main);
            font-weight: 500;
        }

        .topic-list li {
            margin-bottom: 0.4rem;
        }

        .sub-note {
            font-size: 0.85em;
            color: var(--text-muted);
            list-style: none;
            margin-left: -1.2rem;
            margin-top: 0.2rem;
            margin-bottom: 0.5rem;
            font-style: italic;
        }

        .btn-link {
            background-color: var(--button-bg);
            color: var(--button-text);
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            white-space: nowrap;
            transition: opacity 0.2s;
            text-align: center;
        }

        .btn-link:hover {
            opacity: 0.9;
        }

        .btn-disabled {
            background-color: var(--highlight-bg);
            color: var(--text-muted);
            cursor: not-allowed;
            pointer-events: none;
            border: 1px dashed var(--border-color);
        }

        /* --- Mobile Tweaks --- */
        @media (max-width: 768px) {
            .header-top { flex-direction: column; align-items: flex-start; }
            .controls-wrapper { width: 100%; justify-content: flex-start; }
            .section-nav { justify-content: flex-start; }
            
            .day-card {
                flex-direction: column;
                align-items: stretch;
            }
            .day-info {
                flex-direction: column;
                gap: 1rem;
            }
            .day-badge {
                width: auto;
                display: inline-block;
            }
        }
    </style>
</head>
<body>

    <header id="main-header">
        <div class="header-top">
            <h1>CP-Heme Practice Quizzes</h1>
            <div class="controls-wrapper">
                
                <!-- LIVE VIEWER TRACKER (Umami API) -->
                <div class="live-tracker" title="Active Users">
                    <span class="live-dot"></span>
                    <span id="live-count-display">Live: ...</span>
                </div>

                <!-- Pin Button -->
                <button class="pin-btn pin-active" id="pin-btn" onclick="toggleHeader()" title="Pin/Unpin Header">
                    üìç
                </button>
                
                <div class="theme-control">
                    <label for="theme-select">Theme:</label>
                    <select id="theme-select" onchange="changeTheme(this.value)">
                        <option value="dark">Modern Dark</option>
                        <option value="midnight">Midnight</option>
                        <option value="light">Modern Light</option>
                        <option value="legacy-dark">Legacy Dark</option>
                        <option value="sepia">Sepia</option>
                        <option value="contrast">High Contrast</option>
                    </select>
                </div>
            </div>
        </div>
        <!-- Dynamic Navigation Bar injected via JS -->
        <div class="section-nav" id="section-nav"></div>
    </header>

    <div class="container" id="directory-root">
        
        <!-- WEEK 24 -->
        <div class="week-section" id="week-24">
            <h2 class="week-title">Week 24</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon</div>
                    <ul class="topic-list">
                        <li>Blood, Body Fluids, and Cardiovascular Physiology</li>
                        <li>Histology of Peripheral Blood</li>
                        <li>Heme Synthesis and Porphyria</li>
                        <li>Anemia</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-24-Monday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Tues</div>
                    <ul class="topic-list">
                        <li>Hemolytic Anemias</li>
                        <li>Hemostasis, Thrombosis, and Bleeding Disorders I</li>
                        <li>Hemostasis, Thrombosis, and Bleeding Disorders II</li>
                        <li>Anticoagulant Therapy</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-24-Tuesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed & Thurs</div>
                    <ul class="topic-list">
                        <li>Hemoglobinopathies</li>
                        <li>Malaria</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-24-Wednesday-Thursday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 25 -->
        <div class="week-section" id="week-25">
            <h2 class="week-title">Week 25</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon & Tues</div>
                    <ul class="topic-list">
                        <li>Hematopoiesis and Lymphoid System</li>
                        <li>Lymphoid Malignancies (I + II)</li>
                        <li>Myeloid Neoplasms (I + II)</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-25-Monday-Tuesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed</div>
                    <ul class="topic-list">
                        <li>Infection in the Neutropenic Patient</li>
                        <li>Transfusion Medicine & Stem Cell Therapy</li>
                        <li>Cancer Chemotherapy</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-25-Wednesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 26 -->
        <div class="week-section" id="week-26">
            <h2 class="week-title">Week 26</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Tues & Wed</div>
                    <ul class="topic-list">
                        <li>Thoracic Wall, Heart, and Mediastinum</li>
                        <li>Cardiovascular Histology</li>
                        <li>Cardiac Cycle & Physiology of the ECG</li>
                        <li>Clinical Assessment of the Cardiovascular System & Clinical ECG Interpretation</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-26-Tuesday-Wednesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed & Thurs</div>
                    <ul class="topic-list">
                        <li>Circulatory and Capillary Hemodynamics</li>
                        <li>Regulation of Blood Flow & Venous Return</li>
                        <li>Heart Sounds and Auscultation</li>
                        <li>Determinants of Stroke Volume and Cardiac Output</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-26-Wednesday-Thursday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 27 -->
        <div class="week-section" id="week-27">
            <h2 class="week-title">Week 27</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon & Tues</div>
                    <ul class="topic-list">
                        <li>Vascular Pathology</li>
                        <li>Peripheral Vascular Disease</li>
                        <li>Cardiovascular System Development (I + II)</li>
                        <li>Cardiomyopathies</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-27-Monday-Tuesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed & Thurs</div>
                    <ul class="topic-list">
                        <li>Management of Cardiac Arrhythmias</li>
                        <li>Valvular Heart Disease</li>
                        <li class="sub-note">‚Ä¢ Citations sources corrected, pg numbers might be off by -1</li>
                        <li>Cardiac Antiarrhythmics</li>
                        <li>Congenital Heart Disorders</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-27-Wednesday-Thursday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 28 -->
        <div class="week-section" id="week-28">
            <h2 class="week-title">Week 28</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon & Tues</div>
                    <ul class="topic-list">
                        <li>Physiology of Shock and Rapid Blood Pressure Control</li>
                        <li>Chronic Blood Pressure Control and Hypertension</li>
                        <li>ANS Overview & Adrenergics</li>
                        <li>Cardiac Pathology</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-28-Monday-Tuesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed & Thurs</div>
                    <ul class="topic-list">
                        <li>Clinical Diagnosis of Hypertension/Primary Hypoaldosteronism</li>
                        <li>DVT & Pulmonary Embolism</li>
                        <li>Antihypertensives</li>
                        <li>Lipid Lowering Drugs</li>
                        <li>Antihypertensives: Autonomic</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-28-Wednesday-Thursday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 29 -->
        <div class="week-section" id="week-29">
            <h2 class="week-title">Week 29</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon & Tues</div>
                    <ul class="topic-list">
                        <li>Superficial & Deep Neck</li>
                        <li>Coronary Artery Disease</li>
                        <li>Heart Failure: Whole Body Integration</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-29-Monday-Tuesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Tues & Wed</div>
                    <ul class="topic-list">
                        <li>Diagnostic Criteria for Heart Failure</li>
                        <li class="sub-note">‚Ä¢ Updated citations to 2026 version</li>
                        <li>Congestive Heart Failure Treatment (I, II, III)</li>
                        <li>Antianginals</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-29-Tuesday-Wednesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed</div>
                    <ul class="topic-list">
                        <li>Acute Coronary Syndrome/Management of Non-Coronary Chest Pain</li>
                        <li>Cardiac Intervention & Surgery</li>
                        <li>Endo/Pericarditis</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/Week-29-Wednesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 30 -->
        <div class="week-section" id="week-30">
            <h2 class="week-title">Week 30</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon</div>
                    <ul class="topic-list">
                        <li>Upper Respiratory Tract Anatomy</li>
                        <li>Pleural Cavity and Lungs</li>
                        <li>Respiratory Histology</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-30-Monday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Tues</div>
                    <ul class="topic-list">
                        <li>Mechanics and Ventilation</li>
                        <li>Gas Exchange & Diffusion</li>
                        <li>Gas Transport</li>
                        <li>Pediatric Viral Infections</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-30-Tuesday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed & Thurs</div>
                    <ul class="topic-list">
                        <li>PFTs, ABGs, and Diagnosing Gas Exchange</li>
                        <li>Clinical Approach to COPD</li>
                        <li>Pathology of Obstructive Lung Disease</li>
                        <li>COPD Treatment</li>
                        <li>Asthma Diagnosis and Treatment</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-30-Wednesday-Thursday-Practice-Quiz/" target="_blank" class="btn-link">Take Quiz</a>
            </div>
        </div>

        <!-- WEEK 31 -->
        <div class="week-section" id="week-31">
            <h2 class="week-title">Week 31</h2>
            
            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Mon & Tues</div>
                    <ul class="topic-list">
                        <li>Upper Respiratory Infections</li>
                        <li>Pulmonary Circulation: Ventilation and Perfusion</li>
                        <li>Development of the Body Cavities and Respiratory System</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-31-Quiz-1/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Tues</div>
                    <ul class="topic-list">
                        <li>Pulmonary Hypertension</li>
                        <li>ARDS & Neonatal Respiratory Distress Syndrome</li>
                        <li>Pathology of Vascular Infectious Pulmonary Disorders</li>
                    </ul>
                </div>
                <a href="https://ibecerramcg.github.io/CP-Heme-Week-31-Quiz-2/" target="_blank" class="btn-link">Take Quiz</a>
            </div>

            <div class="day-card">
                <div class="day-info">
                    <div class="day-badge">Wed & Thurs</div>
                    <ul class="topic-list">
                        <li>Pathology of Interstitial Lung Disease</li>
                        <li>Clinical Approach to Interstitial Lung Disease</li>
                        <li>Clinical Presentation of Pulmonary Hypertension Cases</li>
                        <li class="sub-note">‚Ä¢ Chest Imaging may not be included, image-based</li>
                    </ul>
                </div>
                <a href="#" class="btn-link btn-disabled">Link Pending</a>
            </div>
        </div>

    </div>

    <script>
        const mainHeader = document.getElementById('main-header');
        const themeSelect = document.getElementById('theme-select');
        const pinBtn = document.getElementById('pin-btn');
        const sectionNav = document.getElementById('section-nav');

      // --- Custom Live Viewer Script using Umami API ---
        async function fetchLiveUsers() {
            const websiteId = '3cb2ed63-b477-4c85-a83f-7352712d49c9';
            const apiKey = 'api_lGvz88HE8YgUBZAlmLUdqu4icYJ5aFxA'; 
            const displayEl = document.getElementById('live-count-display');

            try {
                const url = `https://api.umami.is/v1/websites/${websiteId}/active?t=${Date.now()}`;
                
                const response = await fetch(url, {
                    method: 'GET',
                    cache: 'no-store',
                    headers: {
                        'x-umami-api-key': apiKey,
                        'Accept': 'application/json'
                    }
                });

                if (!response.ok) throw new Error(`API Error: ${response.status}`);

                const data = await response.json();
                
                // Parse the exact JSON structure: {"visitors": 4}
                const count = (data && data.visitors !== undefined) ? data.visitors : 0;

                // Adjust grammar for singular vs plural
                const viewerText = count === 1 ? 'viewer' : 'viewers';

                // Display the new formatted text
                displayEl.textContent = `Live: ${count} ${viewerText}`;

            } catch (err) {
                // Handle strict privacy blockers cleanly
                console.warn("Umami connection blocked or failed:", err);
                displayEl.textContent = `Live: - viewers`;
            }
        }

        function initDirectory() {
            // Build Navigation
            const weekTitles = document.querySelectorAll('.week-title');
            
            weekTitles.forEach(title => {
                const sectionId = title.parentElement.id;
                const navBtn = document.createElement('button');
                navBtn.textContent = title.textContent;
                navBtn.onclick = () => {
                    document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
                };
                sectionNav.appendChild(navBtn);
            });

            // Theme & Pin Logic
            const savedTheme = localStorage.getItem('quizTheme') || 'dark';
            changeTheme(savedTheme);
            themeSelect.value = savedTheme;

            const savedPinState = localStorage.getItem('headerPinned');
            if (savedPinState === 'false') {
                toggleHeader(false); 
            } else {
                toggleHeader(true);
            }

            // Start Live Tracker with a 2-second delay to allow the tracking script to fire first
            setTimeout(() => {
                fetchLiveUsers(); 
                setInterval(fetchLiveUsers, 30000); // Update every 30s
            }, 2000);
        }

        function changeTheme(themeName) {
            document.documentElement.setAttribute('data-theme', themeName);
            localStorage.setItem('quizTheme', themeName);
        }

        function toggleHeader(forceState) {
            const isCurrentlyPinned = !mainHeader.classList.contains('unpinned');
            const newState = (typeof forceState === 'boolean') ? forceState : !isCurrentlyPinned;

            if (newState) {
                mainHeader.classList.remove('unpinned');
                pinBtn.classList.add('pin-active');
                localStorage.setItem('headerPinned', 'true');
            } else {
                mainHeader.classList.add('unpinned');
                pinBtn.classList.remove('pin-active');
                localStorage.setItem('headerPinned', 'false');
            }
        }

        // Initialize on DOM load
        document.addEventListener('DOMContentLoaded', initDirectory);
    </script>
</body>
</html>